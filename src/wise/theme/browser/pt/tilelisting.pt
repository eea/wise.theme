<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  lang="en"
  metal:use-macro="context/main_template/macros/master"
  i18n:domain="plone">

  <metal:content-core fill-slot="content-core">
    <metal:content-core define-macro="content-core">

      <div tal:condition="context/text|nothing" tal:replace="structure context/text/output">
        <p>Folder description</p>
      </div>

      <div class="row">
        <div class="col-xs-12 col-md-4"
             tal:repeat="item context/listFolderContents">
          <div class="tile-listing"
              tal:define="summary_id python: 'summary_' + item.title.lower().replace(' ', '_');
                          url python: item.absolute_url() + '/@@images/image'">

            <div class="tile-listing-wrapper">
              <a class="pat-plone-modal title"
                 tal:attributes="href python: '#' + summary_id">
                <div tal:condition="item/image"
                     class="tile-image tile-listing-image"
                     tal:attributes="style string:background-image:url('${url}')">
                </div>
                <h4 tal:content="item/title">Title</h4>
              </a>
            </div>

            <div tal:attributes="id summary_id"
                 style="display: none"
                 class="tile-modal">
              <h1 tal:content="item/title">Title</h1>
              <div class="tile-listing-content">
                <div tal:condition="item/image"
                     class="tile-image tile-modal-image"
                     tal:attributes="style string:background-image:url('${url}')">
                </div>
                <div class="tile-desc">
                  <p tal:condition="item/text|nothing"
                     tal:replace="structure item/text/output">Summary</p>
                </div>
              </div>
              <div class="formControls">
                <input class="modal-btn standalone"
                       type="submit"
                       value="Cancel" />
                <a class="modal-btn context"
                   tal:attributes="href python: item.absolute_url()">Read more</a>
              </div>
            </div>

          </div>
        </div>
      </div>

      <script>
        jQuery(document).ready(function() {
          $('.pat-plone-modal').patPloneModal({
            position: 'center middle',
            content: '.tile-listing-content',
            buttons: '.formControls > .modal-btn',
            backdropOptions: {
              closeOnEsc: true,
              closeOnClick: true,
            },
            automaticallyAddButtonActions: false,
            actionOptions: {
              displayInModal: true,
              reloadWindowOnClose: false
            },
            actions: {
              '.standalone': {
                modalFunction: 'hide',
              }
            }
          });
        });
      </script>

    </metal:content-core>
  </metal:content-core>
</html>
