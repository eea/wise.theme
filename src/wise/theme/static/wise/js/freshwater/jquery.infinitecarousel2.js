!function(a){a.fn.extend({infiniteCarousel:function(b){var c={transitionSpeed:800,displayTime:6e3,textholderHeight:.25,displayProgressBar:!0,displayThumbnails:!0,displayThumbnailNumbers:!0,displayThumbnailBackground:!0,thumbnailWidth:"20px",thumbnailHeight:"20px",thumbnailFontSize:".7em",easeLeft:"linear",easeRight:"linear",imagePath:"/js/infinitecarousel/images/",inView:1,padding:"0px",advance:1,showControls:!0,autoHideControls:!1,autoHideCaptions:!1,autoStart:!0,prevNextInternal:!0,enableKeyboardNav:!0,onSlideStart:function(){},onSlideEnd:function(){},onPauseClick:function(){}},b=a.extend(c,b);return this.each(function(){function c(b){b=null==b?v.displayTime:b,a("#progress"+u).width("100%").height(5),a("#progress"+u).animate({width:0},b)}function d(b,c){y&&(a("#minmax"+u+"_"+c).hide(),a("#close"+u+"_"+c).hide()),null!=b&&(a("#textholder"+u+"_"+c+" span").html(b),a("#textholder"+u+"_"+c).stop().animate({marginBottom:"0px"},500),a("#minmax"+u+"_"+c).css("background-position","0 -8px"),e())}function e(){y||(a(".minmax",w).fadeIn(250),a(".close",w).fadeIn(250))}function f(){a(".textholder",w).stop().animate({marginBottom:-A*v.textholderHeight-C-1+"px"},v.transitionSpeed)}function g(b){target_num=this.id.split("_"),F[0]!=target_num[1]&&(H="pause",a("#progress"+u).stop().fadeOut(),clearTimeout(J),a("#thumbs"+u+" div").css({cursor:"default"}).unbind("click"),y=0,setTimeout(function(){a("#play_pause_btn"+u).css("background-position","0 -16px")},v.transitionSpeed)),target_num[1]>F[0]&&(diff=target_num[1]-F[0],s(diff)),target_num[1]<F[0]&&(diff=F[0]-target_num[1],t(diff))}function h(){a("#play_pause_btn"+u).stop().animate({top:"3px",right:"3px"},250),a("#btn_rt"+u).stop().animate({top:arrowsTop+"px",right:"2px"},250),a("#btn_lt"+u).stop().animate({top:arrowsTop+"px",left:"2px"},250)}function j(){a("#play_pause_btn"+u).stop().animate({top:-16-C+"px",right:-16-C+"px"},250),a("#btn_rt"+u).stop().animate({right:"-16px"},250),a("#btn_lt"+u).stop().animate({left:"-16px"},250)}function k(){for(I=!0,i=1;i<=v.inView;i++)d(a("li:eq("+i+") p",w).html(),i)}function l(){I=!1,f()}function m(){v.enableKeyboardNav&&a(document).keydown(function(b){39==b.keyCode&&(n("next"),a(document).unbind("keydown")),37==b.keyCode&&(n("prev"),a(document).unbind("keydown")),80!=b.keyCode&&111!=b.keyCode||o(),83!=b.keyCode&&115!=b.keyCode||(p(),a(document).unbind("keydown"))})}function n(b){v.onPauseClick.call(this),a("#btn_rt"+u).unbind("click"),a("#btn_lt"+u).unbind("click"),setTimeout(function(){a("#play_pause_btn"+u).css("background-position","0 -16px")},v.transitionSpeed-1),y=0,a("#progress"+u).stop().fadeOut(),H="pause",clearTimeout(J),"prev"==b?t():s(),a("#play_pause_btn"+u).unbind("click"),setTimeout(function(){a("#play_pause_btn"+u).bind("click",function(){p()}),a("#btn_rt"+u).bind("click",function(){n("next")}),a("#btn_lt"+u).bind("click",function(){n("prev")})},v.transitionSpeed)}function o(){a("#play_pause_btn"+u).unbind("click"),y&&(v.onPauseClick.call(this),a("#play_pause_btn"+u).fadeTo(250,0,function(){a(this).css({"background-position":"0 -16px",opacity:".5"})}).animate({opacity:.5},250),y=0,e(),a("#progress"+u).stop().fadeOut(),clearTimeout(J),setTimeout(function(){a("#play_pause_btn"+u).bind("click",function(){p()})},v.transitionSpeed))}function p(){a("#play_pause_btn"+u).unbind("click"),y||(setTimeout(function(){a("#play_pause_btn"+u).css("background-position","0 0")},v.transitionSpeed-1),y=1,s(),J=setInterval(function(){s()},v.displayTime+v.transitionSpeed),setTimeout(function(){a("#play_pause_btn"+u).bind("click",function(){o()})},v.transitionSpeed))}function q(){if(f(),v.showControls&&v.prevNextInternal&&(a("#play_pause_btn"+u).fadeOut(200),a("#btn_lt"+u).fadeOut(200),a("#btn_rt"+u).fadeOut(200)),v.displayThumbnails)for(i=1;i<=z;i++)a("#thumb"+u+"_"+i).css({"border-color":"#ccc"}).animate({opacity:.65},500),a("#thumb"+u+"_"+i).attr("class","thumb")}function r(){if(v.showControls&&v.prevNextInternal&&(a("#play_pause_btn"+u).fadeIn(200),a("#btn_lt"+u).fadeIn(200),a("#btn_rt"+u).fadeIn(200)),m(),v.autoHideCaptions&&I&&k(),v.displayThumbnails)for(i=0;i<F.length;i++)a("#thumb"+u+"_"+F[i]).css({"border-color":"#ff0000"}).animate({opacity:1},500),a("#thumb"+u+"_"+F[i]).attr("class","thumb_focus");if(!v.autoHideCaptions)for(i=1;i<=v.inView;i++)d(a("li:eq("+i+") p",w).html(),i);for(v.displayThumbnails&&a("#thumbs"+u+" div").bind("click",g).css({cursor:"pointer"}),ary=[],x=1;x<=v.inView;x++)ary.push(a("img:eq("+x+")",w).attr("src"));v.onSlideEnd.call(this,ary)}function s(b){if(null==b&&(b=v.advance),q(),v.displayThumbnails)for(i=1;i<=b;i++)F.push(G.shift()),G.push(F.shift());0==v.displayTime&&clearInterval(J),a("li:lt("+b+")",w).clone(!0).insertAfter(a("li:last",w)),v.onSlideStart.call(this,F,"left"),a("ul",w).animate({left:-B*(b+1)-parseInt(v.padding)*(b+1)*2},v.transitionSpeed,v.easeLeft,function(){a("li:lt("+b+")",w).remove(),a(this).css({left:-B-2*parseInt(v.padding)}),v.displayProgressBar&&y&&c(),r(),0==v.displayTime&&s()})}function t(b){if(null==b&&(b=v.advance),q(),v.displayThumbnails)for(i=1;i<=b;i++)F.unshift(G.pop()),G.unshift(F.pop());a("li:gt("+(z-(b+1))+")",w).clone(!0).insertBefore(a("li:first",w)),v.onSlideStart.call(this,F,"right"),a("ul",w).css("left",-(B*(b+1))-parseInt(v.padding)*(2*(b+1))).animate({left:-B-2*parseInt(v.padding)},v.transitionSpeed,v.easeRight,function(){a("li:gt("+(z-1)+")",w).remove(),r()})}var u=Math.round(1e8*Math.random()),v=b,w=a(this),y=v.autoStart,z=a("img",w).length,A=a("img:first",w).height(),B=a("img:first",w).width();v.inView>z-1&&(v.inView=z-1),a("p",w).hide(),a(w).css({position:"relative",overflow:"hidden"}).width(B*v.inView+v.inView*parseInt(v.padding)*2).height(A+2*parseInt(v.padding)),a("ul",w).css({"list-style":"none",margin:"0",padding:"0",position:"relative"}).width(B*z),a("li",w).css({display:"inline","float":"left",padding:v.padding}),a("li:last",w).prependTo(a("ul",w)),a("ul",w).css("left",-B-2*parseInt(v.padding)+"px").width(9999),v.displayProgressBar&&(a(w).append('<div id="progress'+u+'" class="ic-progress-bar" style="position:absolute;bottom:0;background:#bbb;left:0;z-index:1"></div>'),a("#progress"+u).width("100%").height(5).css("opacity",".6"));var C=parseInt(a(w).css("border-bottom-width"))+parseInt(a(w).css("border-top-width"));isNaN(C)&&(C=0);var D=parseInt(a(w).css("padding-left"));for(i=1;i<=v.inView;i++)a(w).append('<div id="textholder'+u+"_"+i+'" class="textholder" style="position:absolute;width:'+B+"px;bottom:0px;margin-bottom:"+-(A*v.textholderHeight+C)+'px;"><span></span></div>'),a("#textholder"+u+"_"+i).css({left:(i-1)*(B+2*parseInt(v.padding)),"margin-left":parseInt(v.padding)+D,"margin-right":v.padding}),a("#textholder"+u+"_"+i).height(A*v.textholderHeight).css({backgroundColor:"#FFF",opacity:"0.5"}),html='<div class="minmax" id="minmax'+u+"_"+i+'" style="width:8px;height:8px;position:absolute;top:1px;right:10px;cursor:pointer;background:url('+v.imagePath+'caption.gif) no-repeat 0 -8px"></div>',html+='<div class="close" id="close'+u+"_"+i+'" style="width:8px;height:8px;position:absolute;top:1px;right:1px;cursor:pointer;background:url('+v.imagePath+'caption.gif) no-repeat 0 0"></div>',a("#textholder"+u+"_"+i).append(html),a("#minmax"+u+"_"+i).hide(),a("#close"+u+"_"+i).hide(),v.autoHideCaptions||d(a("li:eq("+i+") p",w).html(),i);var E=parseInt(a("#textholder"+u+"_1").css("padding-left"))+parseInt(a("#textholder"+u+"_1").css("padding-right"));if(E>0&&a(".textholder",w).width(B-E),a(".close",w).each(function(b){a(this).click(function(){a("#textholder"+u+"_"+(b+1)).animate({marginBottom:-A*v.textholderHeight-C-1+"px"},500)})}),a(".minmax",w).each(function(b){a(this).click(function(){0==parseInt(a("#textholder"+u+"_"+(b+1)).css("margin-bottom"))?a("#textholder"+u+"_"+(b+1)).animate({marginBottom:-A*v.textholderHeight-C+12+"px"},500,function(){a("#minmax"+u+"_"+(b+1)).css("background-position","0 -16px")}):a("#textholder"+u+"_"+(b+1)).animate({marginBottom:"0px"},500,function(){a("#minmax"+u+"_"+(b+1)).css("background-position","0 -8px")})})}),v.displayThumbnails){var F=[],G=[];for(a(w).after('<div id="thumbs'+u+'" style="position:relative;overflow:auto;clear:left;text-align:left;padding-top:5px;"></div>'),i=0;i<=z-1;i++)thumb=a("img:eq("+(i+1)+")",w).attr("src"),a("#thumbs"+u).append('<div class="thumb" id="thumb'+u+"_"+(i+1)+'" style="position:relative;cursor:pointer;background-image:url('+thumb+");display:inline;float:left;width:"+v.thumbnailWidth+";height:"+v.thumbnailHeight+";line-height:"+v.thumbnailHeight+";padding:0;overflow:hidden;text-align:center;border:2px solid #ccc;margin-right:4px;font-size:"+v.thumbnailFontSize+';font-family:Arial;color:#000;text-shadow:0 0 3px #fff">'+(i+1)+"</div>"),i<=v.inView&&(a("#thumb"+u+"_"+i).css({"border-color":"#ff0000"}),a("#thumb"+u+"_"+i).attr("class","thumb_focus")),G.push(i+1);for(i=1;i<=v.inView;i++)F.push(G.shift());thumb=a("img:first",w).attr("src"),a("#thumb"+u+"_"+z).css({"background-image":"url("+thumb+")"}),a("#thumbs"+u+" div.thumb:not(:first)").css({opacity:.65}),a("#thumbs"+u+" div.thumb").hover(function(){a(this).animate({opacity:1},150)},function(){F[0]!=this.id.split("_")[1]&&a(this).animate({opacity:.65},250)}),a("#thumbs"+u+" div").bind("click",g),v.displayThumbnailNumbers||a("#thumbs"+u+" div").text(""),v.displayThumbnailBackground||a("#thumbs"+u+" div").css({"background-image":"none"})}if(v.showControls){html='<div id="play_pause_btn'+u+'" style="cursor:pointer;position:absolute;top:3px;right:3px;border:none;width:16px;height:16px;background:url('+v.imagePath+'playpause.gif) no-repeat 0 0"></div>',a(w).append(html);var H="play";if(a("#play_pause_btn"+u).css("opacity",.5).hover(function(){a(this).animate({opacity:"1"},250)},function(){a(this).animate({opacity:".5"},250)}),a("#play_pause_btn"+u).click(function(){H="play"==H?"pause":"play","play"==H?p():o()}),v.prevNextInternal||(wrapID=a(w).attr("id")+"Wrapper",a(w).wrap('<div id="'+wrapID+'"></div>').css("margin","0 auto"),a("#"+wrapID).css("position","relative").width(a(w).width()+40+parseInt(a(w).css("padding-left"))+parseInt(a(w).css("padding-right")))),arrowsTop=A/2-15+parseInt(v.padding),html='<div id="btn_rt'+u+'" style="position:absolute;right:2px;top:'+arrowsTop+"px;cursor:pointer;border:none;width:13px;height:30px;background:url("+v.imagePath+'leftright.gif) no-repeat 0 0"></div>',html+='<div id="btn_lt'+u+'" style="position:absolute;left:2px;top:'+arrowsTop+"px;cursor:pointer;border:none;width:13px;height:30px;background:url("+v.imagePath+'leftright.gif) no-repeat -13px 0"></div>',v.prevNextInternal?a(w).append(html):a("#"+wrapID).append(html),a("#btn_rt"+u).css("opacity",.5).click(function(){n("next")}).hover(function(){a(this).animate({opacity:"1"},250)},function(){a(this).animate({opacity:".5"},250)}),a("#btn_lt"+u).css("opacity",.5).click(function(){n("prev")}).hover(function(){a(this).animate({opacity:"1"},250)},function(){a(this).animate({opacity:".5"},250)}),v.autoHideControls&&v.prevNextInternal&&(a(w).hover(h,j),j()),v.autoHideCaptions){var I;a(w).hover(k,l),f()}}if(y){var J=setInterval(function(){s()},v.displayTime+v.transitionSpeed);v.displayProgressBar&&c(v.displayTime+v.transitionSpeed)}else H="pause",a("#play_pause_btn"+u).css({"background-position":"0 -16px"});m()})}})}(jQuery);